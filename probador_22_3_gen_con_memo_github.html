<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Probador 22_3 - 5 Franjas</title>
<style>
body{font-family:Arial;text-align:center;padding:20px;margin:0}
#armarioApp{max-width:1400px;margin:auto}
.armario-seccion{display:grid;grid-template-columns:220px auto 1fr auto;gap:10px;margin-bottom:40px;align-items:start}
.cuadro{width:200px;height:200px;border:2px solid #333;display:flex;justify-content:center;align-items:center;background:#f5f5f5;overflow:hidden}
.cuadro img{max-width:100%;max-height:100%;transition:transform .3s;transform-origin:center center;cursor:pointer}
.armario-wrapper{overflow-x:auto;white-space:nowrap;padding:10px;border:1px solid #ccc;background:#fafafa;margin-top:5px}
.armario{display:inline-flex;gap:5px}
.armario img{width:120px;height:120px;object-fit:cover;cursor:grab;border:2px solid transparent;transition:transform .2s,border .2s}
.armario img:hover{transform:scale(1.6);border:2px solid #333}
button{padding:8px 12px;cursor:pointer;border-radius:6px;border:1px solid #333;background:#f0f0f0;transition:background .2s;margin:2px}
button:hover{background:#ddd}
input[type=file]{display:none}
</style>
</head>
<body>
<div id="armarioApp">Probador 22_3 - 5 Franjas</div>
<script>
(function(){
  var f=["sombrero","logo","blusa","pantalon","zapatos"],a=document.getElementById("armarioApp"),e={};

  f.forEach(function(x){
    var s=document.createElement("div");s.className="armario-seccion";
    var c=document.createElement("div");c.className="cuadro";c.id="cuadro-"+x;if(x==="logo")c.innerHTML="<p>Logo</p>";
    var cs=document.createElement("div"),i=document.createElement("input");i.type="file";i.multiple=true;i.id="file-"+x;i.addEventListener("change",function(ev){sI(x,ev.target.files)});
    var b=document.createElement("button");b.textContent="Select";b.onclick=function(){i.click()};cs.append(i,b);
    var w=document.createElement("div");w.className="armario-wrapper";var ar=document.createElement("div");ar.className="armario";ar.id="armario-"+x;w.appendChild(ar);
    var cv=document.createElement("div"),bv=document.createElement("button");bv.textContent="Vaciar Armario";bv.onclick=function(){vA(x)};cv.appendChild(bv);
    s.append(c,cs,w,cv);a.appendChild(s);cA(x);
  });

  function sI(franja,files){[...files].forEach(function(file){var r=new FileReader();r.onload=function(ev){gI(franja,ev.target.result);aA(franja,ev.target.result)};r.readAsDataURL(file)})}
  function gI(franja,src){var d=JSON.parse(localStorage.getItem("armario_"+franja)||"[]");d.push(src);localStorage.setItem("armario_"+franja,JSON.stringify(d))}
  function cA(franja){var d=JSON.parse(localStorage.getItem("armario_"+franja)||"[]");d.forEach(function(src){aA(franja,src)})}
  function aA(franja,src){var ar=document.getElementById("armario-"+franja),im=document.createElement("img");im.src=src;im.draggable=true;
    im.addEventListener("dragstart",function(ev){ev.dataTransfer.setData("text/plain",src);ev.dataTransfer.effectAllowed="move"});
    im.onclick=function(){mC(franja,src)};im.onmouseover=function(){mC(franja,src)};ar.appendChild(im)
  }
  f.forEach(function(x){var ar=document.getElementById("armario-"+x);ar.addEventListener("dragover",function(e){e.preventDefault()});ar.addEventListener("drop",function(e){e.preventDefault();var sD=e.dataTransfer.getData("text/plain");if(!sD)return;var d=JSON.parse(localStorage.getItem("armario_"+x)||"[]");var fi=d.indexOf(sD);var ch=Array.from(ar.children);var ti=ch.indexOf(e.target.closest("img"));if(ti===-1)ti=d.length-1;if(fi>-1){d.splice(fi,1);d.splice(ti,0,sD);localStorage.setItem("armario_"+x,JSON.stringify(d));ar.innerHTML="";d.forEach(function(s){aA(x,s)})}})});
  
  function mC(franja,src){var c=document.getElementById("cuadro-"+franja);c.innerHTML='<img src="'+src+'">';if(!e[franja])e[franja]={escala:1,angulo:0};var im=c.querySelector("img");apT(franja);
    im.onwheel=function(ev){ev.preventDefault();ev.deltaY<0?e[franja].angulo-=15:e[franja].angulo+=15;apT(franja)};
    var sx=null;im.ontouchstart=function(ev){sx=ev.touches[0].clientX};im.ontouchmove=function(ev){if(sx===null)return;var dx=ev.touches[0].clientX-sx;e[franja].angulo+=dx*.5;apT(franja);sx=ev.touches[0].clientX};im.ontouchend=function(){sx=null};
    im.onmouseleave=function(){im.style.transform="scale(1) rotate("+e[franja].angulo+"deg)";e[franja].escala=1}
  }
  function apT(franja){var im=document.querySelector("#cuadro-"+franja+" img");if(im)im.style.transform="scale(2.2) rotate("+e[franja].angulo+"deg)"}
  function vA(franja){document.getElementById("armario-"+franja).innerHTML="";document.getElementById("cuadro-"+franja).innerHTML=(franja==="logo"?"<p>Logo</p>":"");localStorage.removeItem("armario_"+franja);e[franja]={escala:1,angulo:0}}
})();
</script>
</body>
</html>
