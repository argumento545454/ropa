<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>fotos_02_pc_camara_celular - Fotos unificadas PC y Celular</title>
<style>
  body { text-align: center; font-family: Arial; margin-top: 20px; }
  video, canvas, img { border: 2px solid #ccc; border-radius: 10px; margin: 10px; width:320px; height:240px; }
  button, input { margin: 10px; padding: 10px 20px; font-size: 16px; }
</style>
</head>
<body>

<h2>fotos_02_pc_camara_celular</h2>

<!-- Foto desde PC -->
<input type="file" id="inputFotoPC" accept="image/*">
<br>
<img id="fotoPC" alt="Foto PC" style="display:none;">

<hr>

<!-- Cámara (PC y Celular) -->
<video id="video" autoplay playsinline></video>
<br>
<button id="btnTomarFoto">Tomar Foto</button>
<br>
<canvas id="canvas" style="display:none;"></canvas>
<img id="fotoCamara" alt="Foto Cámara" style="display:none;">

<hr>

<!-- Foto desde galería móvil -->
<input type="file" id="inputFotoCelular" accept="image/*">
<br>
<img id="fotoCelular" alt="Foto Celular" style="display:none;">

<script>
// === Foto desde PC ===
const inputFotoPC = document.getElementById('inputFotoPC');
const fotoPC = document.getElementById('fotoPC');

inputFotoPC.addEventListener('change', e => {
  const file = e.target.files[0];
  if(file){
    const reader = new FileReader();
    reader.onload = () => {
      fotoPC.src = reader.result;
      fotoPC.style.display = 'block';
    }
    reader.readAsDataURL(file);
  }
});

// === Cámara unificada (PC y móvil) ===
const video = document.getElementById('video');
const canvas = document.getElementById('canvas');
const btnTomarFoto = document.getElementById('btnTomarFoto');
const fotoCamara = document.getElementById('fotoCamara');

async function iniciarCamara() {
  try {
    const stream = await navigator.mediaDevices.getUserMedia({ video: { facingMode: "environment" } });
    video.srcObject = stream;
  } catch(err) {
    alert('Error al acceder a la cámara: ' + err);
  }
}

btnTomarFoto.addEventListener('click', () => {
  const ctx = canvas.getContext('2d');
  ctx.drawImage(video, 0, 0, canvas.width, canvas.height);
  fotoCamara.src = canvas.toDataURL('image/png');
  fotoCamara.style.display = 'block';
});

iniciarCamara();

// === Foto desde galería móvil ===
const inputFotoCelular = document.getElementById('inputFotoCelular');
const fotoCelular = document.getElementById('fotoCelular');

inputFotoCelular.addEventListener('change', e => {
  const file = e.target.files[0];
  if(file){
    const reader = new FileReader();
    reader.onload = () => {
      fotoCelular.src = reader.result;
      fotoCelular.style.display = 'block';
    }
    reader.readAsDataURL(file);
  }
});
</script>

</body>
</html>