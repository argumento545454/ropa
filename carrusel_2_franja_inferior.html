<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Carrusel 2 Franja Inferior</title>
<style>
body{display:flex;flex-direction:column;align-items:center;justify-content:flex-start;height:100vh;background:#f0f4f8;font-family:Arial,sans-serif;margin:0;padding:20px;position:relative}
#btnSelect,#btnVaciar{padding:8px 15px;border:none;border-radius:6px;color:#fff;cursor:pointer}
#btnSelect{margin-bottom:20px;background:#007bff}
#btnVaciar{position:absolute;top:20px;right:20px;background:#dc3545}
.circle-container{position:relative;width:600px;height:600px;border-radius:50%;margin-bottom:30px}
.circle-container img{position:absolute;width:180px;height:180px;border-radius:10px;object-fit:cover;transition:transform .3s,z-index .3s}
.circle-container img:hover{transform:scale(1.3);z-index:20}
.franja{display:flex;overflow-x:auto;gap:10px;padding:10px;width:90%;border-top:2px solid #ccc;scrollbar-width:thin;scrollbar-color:#888 #f0f4f8}
.franja::-webkit-scrollbar{height:8px}
.franja::-webkit-scrollbar-thumb{background:#888;border-radius:4px}
.thumb-container{position:relative;display:inline-block}
.thumb-container img{width:100px;height:100px;object-fit:cover;border-radius:8px;cursor:pointer;flex-shrink:0;transition:transform .2s}
.thumb-container img:hover{transform:scale(1.1);border:2px solid #333}
.btnEliminar{position:absolute;top:2px;right:2px;background:rgba(220,50,50,.9);color:#fff;border:none;border-radius:50%;width:20px;height:20px;cursor:pointer;font-size:14px;line-height:18px;text-align:center;padding:0}
.btnEliminar:hover{background:red}
#inputFiles{display:none}
</style>
</head>
<body>
<h2>Carrusel 2</h2>
<button id="btnSelect">Select</button>
<input type="file" id="inputFiles" multiple accept="image/*">
<button id="btnVaciar">Vaciar Carrusel</button>
<div class="circle-container" id="circle"></div>
<div class="franja" id="franja"></div>

<script>
document.addEventListener("DOMContentLoaded",function(){(function(){
  var a=[],r=0,s=.01,p=!1,l=0;
  var btnS=document.getElementById("btnSelect"),btnV=document.getElementById("btnVaciar"),c=document.getElementById("circle"),f=document.getElementById("franja"),input=document.getElementById("inputFiles");

  function o(img){ // organizar círculo
    var t=a.length,u=200;
    a.forEach(function(e,i){
      var g=(i/t)*2*Math.PI+r,x=u*Math.cos(g)+c.offsetWidth/2-e.offsetWidth/2,y=u*Math.sin(g)+c.offsetHeight/2-e.offsetHeight/2;
      e.style.left=x+"px";e.style.top=y+"px";
      var n=(g%(2*Math.PI)+2*Math.PI)%(2*Math.PI);
      e.style.zIndex=Math.floor(Math.cos(n)*10)+10;
    });
  }

  function ag(src){ // agregar imagen
    var i=document.createElement("img");
    i.src=src;i.loading="lazy";
    i.addEventListener("mouseenter",()=>p=!0);
    i.addEventListener("mouseleave",()=>p=!1);
    c.appendChild(i);a.push(i);o(i);

    var tc=document.createElement("div");tc.className="thumb-container";
    var t=document.createElement("img");t.src=src;t.loading="lazy";
    t.addEventListener("click",()=>{
      var idx=a.findIndex(x=>x.src===src);
      if(idx>=0){r=-(idx/a.length)*2*Math.PI;o();}
    });
    var be=document.createElement("button");be.className="btnEliminar";be.textContent="×";
    be.onclick=function(e){
      e.stopPropagation();
      var idx=a.findIndex(x=>x.src===src);
      if(idx>=0){var rem=a.splice(idx,1)[0];c.removeChild(rem);}
      f.removeChild(tc);
      gu();
    };
    tc.appendChild(t);tc.appendChild(be);f.appendChild(tc);
  }

  function gu(){ // guardar en local
    localStorage.setItem("carruselImgs",JSON.stringify(a.map(e=>e.src)));
  }

  function cd(){ // cargar desde local
    var d=localStorage.getItem("carruselImgs");
    if(d)JSON.parse(d).forEach(e=>ag(e));
  }

  function vc(){ // vaciar carrusel
    c.innerHTML="";f.innerHTML="";a.length=0;localStorage.removeItem("carruselImgs");r=0;s=.01;
  }

  btnS.addEventListener("click",()=>input.click());
  input.addEventListener("change",e=>{
    for(let file of e.target.files){
      let fr=new FileReader();
      fr.onload=()=>{ag(fr.result);gu();};
      fr.readAsDataURL(file);
    }
  });
  btnV.addEventListener("click",vc);

  c.addEventListener("wheel",e=>{e.preventDefault();s+=e.deltaY*-5e-4});

  function anim(){if(!p){r+=s;var cycles=Math.floor(r/(2*Math.PI));if(cycles>l){l=cycles;if(a.length>1){var f1=a.shift();a.push(f1);}}}o();requestAnimationFrame(anim);}
  anim();
  window.addEventListener("load",cd);
})();
});
</script>
</body>
</html>
